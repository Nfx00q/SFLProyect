<%- include('../partials/header') %>

<div class="container mt-4">
  <h2 class="mb-4"><%= mode === 'edit' ? 'Editar Usuario' : 'Crear Usuario' %></h2>

  <form method="POST" action="<%= mode === 'edit' ? '/admin/users/' + usuario.id_us + '?_method=PUT' : '/admin/users' %>">
    
    <style>
      select {
        text-transform: capitalize;
      }
    </style>

    <% if (mode === 'edit') { %>
      <input type="hidden" name="id_us" value="<%= usuario.id_us %>">
    <% } %>

    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <input type="text" name="nom_us" class="form-control" required value="<%= mode === 'edit' ? usuario.nom_us : '' %>">
      </div>
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input type="email" name="mail_us" class="form-control" required value="<%= mode === 'edit' ? usuario.mail_us : '' %>">
      </div>
    </div>

    <% if (mode === 'create') { %>
      <div class="mb-3">
        <label class="form-label">Contrase√±a</label>
        <input type="password" name="pass_us" class="form-control" required>
      </div>
    <% } %>

    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label">Rol</label>
        <select name="rol_id_rol" class="form-select" required>
          <% roles.forEach(r => { %>
            <option value="<%= r.id_rol %>" <% if (mode === 'edit' && usuario.rol_id_rol === r.id_rol) { %> selected <% } %> >
              <%= r.nom_rol %>
            </option>
          <% }) %>
        </select>
      </div>

      <% if (mode === 'edit') { %>
        <div class="col-md-6">
          <label class="form-label">Estado</label>
          <select name="id_est" class="form-select" required>
            <% estados.forEach(e => { %>
              <option value="<%= e.id_est %>" <% if (usuario.id_est === e.id_est) { %> selected <% } %> >
                <%= e.nom_est %>
              </option>
            <% }) %>
          </select>
        </div>
      <% } %>
    </div>

    <div class="d-flex justify-content-between mt-4">
      <a href="/admin/users" class="btn btn-outline-secondary">Cancelar</a>
      <button type="submit" class="btn btn-primary">
        <%= mode === 'edit' ? 'Guardar Cambios' : 'Crear Usuario' %>
      </button>
    </div>
  </form>
</div>

<%- include('../partials/footer') %>
